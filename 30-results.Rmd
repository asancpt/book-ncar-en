# Results

## NonCompart package: performance of NCA

This package conducts NCA as similarly as possible to the most widely used commercial PK analysis software. 
The NonCompart package has two main functions, tblNCA and sNCA, for use in multiple subjects and one subject, respectively. 
Figure 1 shows an example of output by tblNCA. The input data for tblNCA( ) should be in a long format as exemplified by the Theoph dataset.
It is possible to input several keys such as subject demographics and information regarding dose, period, or sequence; the result of tblNCA( ) will print the key columns and the carried keys can be further used for additional statistical analysis (i.e. descriptive statistics, bioequivalence test, t-test, or ANOVA). 
The adm argument can be 'Extravascular', 'Bolus', or 'Infusion' and the down argument can be either 'Linear' or 'Log'. 
The greatest advantage of this package is that the outputs produced by this package are compatible with those of pharmacokinetic parameter (PP) TESTCD of CDISC SDTM.

```r
tblNCA(Theoph, key = "Subject", colTime = "Time", colConc = "conc", dose = 320, 
       adm = "Extravascular", dur = 0, doseUnit = "mg", timeUnit = "h", concUnit = "mg/L", 
       down = "Linear")
```

IntAUC() function calculates interval (partial) AUC (from t 1 and t 2 ) with the given series of time and concentration. 
The interval AUC (0.5–11 hour) of the subject 8 can be calculated using the Theoph dataset with the following R script.

```{r}
Time = Theoph[Theoph$Subject == 8, "Time"]
Concentration = Theoph[Theoph$Subject == 8, "conc"]
Res = sNCA(Time, Concentration,dose = 320, concUnit = "mg/L")
IntAUC(Time, Concentration, t1 = 0.5, t2 = 11, Res)
```

<!-- # [1] 58.26022 -->

## ncar package: generation of NCA reports

This package generates complete NCA reports including plots
with both linear and logarithmic scale. Its two main functions
are pdfNCA and rtfNCA, which produce pdf file format
and rtf file format, respectively. The generated reports are
similar to those generated from commercial softwares, but like
NonCompart, this package has the advantage of using PPTESTCD of CDISC SDTM. ncar produces NCA reports through
NonCompart and converts them into Microsoft Word format
when using rtfNCA( ), which is convenient for editing. Re-
ports generated by pdfNCA( )function show individual plots
with trend lines that joins the dots used for calculating terminal
slopes. Figure 2 shows an example of an NCA report in pdf for-
mat and an individual concentration-time plot.

```r
pdfNCA(fileName = "pdfNCA-Theoph.pdf",
Theoph, colSubj = "Subject", colTime =
"Time", colConc = "conc", dose = 320,
doseUnit = "mg", timeUnit = "h", concU-
nit = "mg/L", down = "Linear")
```

## Validation of NCA results between R packages and WinNonlin®

To demonstrate the accordance of outputs by ncar package and
WinNonlin®, we performed NCA using Theoph dataset ob-
tained from the R software. For comparison of the NCA results,
we selected the following conditions: extravascular, linear-up
linear-down, and best fit. We found no discrepancy between the
two results as shown in Table \@ref(tab:table2) (a randomized subject, Subject
ID = 8).

```{r table3, echo = FALSE}
kable(read_csv('data-raw/table-3.csv'), caption = 'Comparison of NCA results generated from WinNonlin and ncar package', booktabs = TRUE)
```


In order to further validate these packages, we compared NCA
results using Indometh, another available dataset of the R
software as well as other datasets of a number of subjects from
several phase 1 clinical trials with different dosing routes such
as infusion, bolus, and oral route. As a result, we could not find
any discrepancy between outputs generated by the R packages
and WinNonlin®.

